<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Jiahe (Paddy) ZHAO&#039;s log book</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Jiahe (Paddy) ZHAO&#039;s log book"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Jiahe (Paddy) ZHAO&#039;s log book"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="::: {.cell .code id&amp;#x3D;”KbUQdcbyfwKx”} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172# IMPORTANT: RUN THIS CE"><meta property="og:type" content="blog"><meta property="og:title" content="Jiahe (Paddy) ZHAO&#039;s log book"><meta property="og:url" content="http://example.com/2024/04/30/vertopal.com_[to_be_finished]_House_Price/"><meta property="og:site_name" content="Jiahe (Paddy) ZHAO&#039;s log book"><meta property="og:description" content="::: {.cell .code id&amp;#x3D;”KbUQdcbyfwKx”} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172# IMPORTANT: RUN THIS CE"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:published_time" content="2024-04-30T11:45:26.574Z"><meta property="article:modified_time" content="2024-04-30T11:27:44.751Z"><meta property="article:author" content="Jiahe (Paddy) ZHAO"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2024/04/30/vertopal.com_[to_be_finished]_House_Price/"},"headline":"Jiahe (Paddy) ZHAO's log book","image":["http://example.com/img/og_image.png"],"datePublished":"2024-04-30T11:45:26.574Z","dateModified":"2024-04-30T11:27:44.751Z","author":{"@type":"Person","name":"Jiahe (Paddy) ZHAO"},"publisher":{"@type":"Organization","name":"Jiahe (Paddy) ZHAO's log book","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"::: {.cell .code id&#x3D;”KbUQdcbyfwKx”} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172# IMPORTANT: RUN THIS CE"}</script><link rel="canonical" href="http://example.com/2024/04/30/vertopal.com_[to_be_finished]_House_Price/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Jiahe (Paddy) ZHAO&#039;s log book" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-04-30T11:45:26.574Z" title="2024/4/30 19:45:26">2024-04-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-04-30T11:27:44.751Z" title="2024/4/30 19:27:44">2024-04-30</time></span><span class="level-item">2 hours read (About 19701 words)</span></div></div><div class="content"><p>::: {.cell .code id&#x3D;”KbUQdcbyfwKx”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES</span></span><br><span class="line"><span class="comment"># TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,</span></span><br><span class="line"><span class="comment"># THEN FEEL FREE TO DELETE THIS CELL.</span></span><br><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE&#x27;S PYTHON</span></span><br><span class="line"><span class="comment"># ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR</span></span><br><span class="line"><span class="comment"># NOTEBOOK.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote, urlparse</span><br><span class="line"><span class="keyword">from</span> urllib.error <span class="keyword">import</span> HTTPError</span><br><span class="line"><span class="keyword">from</span> zipfile <span class="keyword">import</span> ZipFile</span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line">CHUNK_SIZE = <span class="number">40960</span></span><br><span class="line">DATA_SOURCE_MAPPING = <span class="string">&#x27;house-price:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F4728541%2F8023939%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240430%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240430T101533Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D7136c65f43939a02722e69b848ca9637e7f96a208197fc6045ffd6197d326a6af0e827362439f14cfc524a110f7d48f0d3f73a573f748fa8482ffed0bbb85ab4caea7b433dbab52e41235cd39b43b2d24cf073828b76a35ba727af84ec47641a0630af6edd20b95265af2ed013ca103cf4a191e4daa3b7bf11c16c6374d7a23dc7ac8706b2d76b2d60e1cb920dee1feeee2506067167d4005415924db6f3771a2837274932060f8b02431a76e1953de252c9913535408fc1ae7240b6ad22b2cf70612b32e0496fe4109e5db56888f0bc1084c66d310d6e4fcc0d5fa1c989e5df309320d2f8c1e21e01870d473d726f168b1be74857bafd3cc4cae112a7d8a5ac&#x27;</span></span><br><span class="line"></span><br><span class="line">KAGGLE_INPUT_PATH=<span class="string">&#x27;/kaggle/input&#x27;</span></span><br><span class="line">KAGGLE_WORKING_PATH=<span class="string">&#x27;/kaggle/working&#x27;</span></span><br><span class="line">KAGGLE_SYMLINK=<span class="string">&#x27;kaggle&#x27;</span></span><br><span class="line"></span><br><span class="line">!umount /kaggle/<span class="built_in">input</span>/ <span class="number">2</span>&gt; /dev/null</span><br><span class="line">shutil.rmtree(<span class="string">&#x27;/kaggle/input&#x27;</span>, ignore_errors=<span class="literal">True</span>)</span><br><span class="line">os.makedirs(KAGGLE_INPUT_PATH, <span class="number">0o777</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">os.makedirs(KAGGLE_WORKING_PATH, <span class="number">0o777</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  os.symlink(KAGGLE_INPUT_PATH, os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&#x27;input&#x27;</span>), target_is_directory=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">except</span> FileExistsError:</span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  os.symlink(KAGGLE_WORKING_PATH, os.path.join(<span class="string">&quot;..&quot;</span>, <span class="string">&#x27;working&#x27;</span>), target_is_directory=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">except</span> FileExistsError:</span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data_source_mapping <span class="keyword">in</span> DATA_SOURCE_MAPPING.split(<span class="string">&#x27;,&#x27;</span>):</span><br><span class="line">    directory, download_url_encoded = data_source_mapping.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    download_url = unquote(download_url_encoded)</span><br><span class="line">    filename = urlparse(download_url).path</span><br><span class="line">    destination_path = os.path.join(KAGGLE_INPUT_PATH, directory)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> urlopen(download_url) <span class="keyword">as</span> fileres, NamedTemporaryFile() <span class="keyword">as</span> tfile:</span><br><span class="line">            total_length = fileres.headers[<span class="string">&#x27;content-length&#x27;</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Downloading <span class="subst">&#123;directory&#125;</span>, <span class="subst">&#123;total_length&#125;</span> bytes compressed&#x27;</span>)</span><br><span class="line">            dl = <span class="number">0</span></span><br><span class="line">            data = fileres.read(CHUNK_SIZE)</span><br><span class="line">            <span class="keyword">while</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">                dl += <span class="built_in">len</span>(data)</span><br><span class="line">                tfile.write(data)</span><br><span class="line">                done = <span class="built_in">int</span>(<span class="number">50</span> * dl / <span class="built_in">int</span>(total_length))</span><br><span class="line">                sys.stdout.write(<span class="string">f&quot;\r[<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span> * done&#125;</span><span class="subst">&#123;<span class="string">&#x27; &#x27;</span> * (<span class="number">50</span>-done)&#125;</span>] <span class="subst">&#123;dl&#125;</span> bytes downloaded&quot;</span>)</span><br><span class="line">                sys.stdout.flush()</span><br><span class="line">                data = fileres.read(CHUNK_SIZE)</span><br><span class="line">            <span class="keyword">if</span> filename.endswith(<span class="string">&#x27;.zip&#x27;</span>):</span><br><span class="line">              <span class="keyword">with</span> ZipFile(tfile) <span class="keyword">as</span> zfile:</span><br><span class="line">                zfile.extractall(destination_path)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">              <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(tfile.name) <span class="keyword">as</span> tarfile:</span><br><span class="line">                tarfile.extractall(destination_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\nDownloaded and uncompressed: <span class="subst">&#123;directory&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> HTTPError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Failed to load (likely expired) <span class="subst">&#123;download_url&#125;</span> to path <span class="subst">&#123;destination_path&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Failed to load <span class="subst">&#123;download_url&#125;</span> to path <span class="subst">&#123;destination_path&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Data source import complete.&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code _cell_guid&#x3D;”b1076dfc-b9ad-4769-8c92-a6c4dae69d19” _uuid&#x3D;”8f2839f25d086af736a60e9eeb907d3b93b6e0e5” id&#x3D;”fs6jI_FDfwK5” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">:::</span><br><span class="line"></span><br><span class="line">::: &#123;.cell .code _cell_guid=<span class="string">&quot;b1076dfc-b9ad-4769-8c92-a6c4dae69d19&quot;</span> _uuid=<span class="string">&quot;8f2839f25d086af736a60e9eeb907d3b93b6e0e5&quot;</span> execution=<span class="string">&quot;&#123;\&quot;iopub.execute_input\&quot;:\&quot;2024-04-29T12:27:00.10128Z\&quot;,\&quot;iopub.status.busy\&quot;:\&quot;2024-04-29T12:27:00.100684Z\&quot;,\&quot;iopub.status.idle\&quot;:\&quot;2024-04-29T12:27:02.682242Z\&quot;,\&quot;shell.execute_reply\&quot;:\&quot;2024-04-29T12:27:02.68068Z\&quot;,\&quot;shell.execute_reply.started\&quot;:\&quot;2024-04-29T12:27:00.101246Z\&quot;&#125;&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;tikQX6RJfwK6&quot;</span> trusted=<span class="string">&quot;true&quot;</span>&#125;</span><br><span class="line">``` python</span><br><span class="line"><span class="comment"># and a Lasso regressor, and combines their predictions.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It borrows ideas from lots of other people&#x27;s scripts, including:</span></span><br><span class="line"><span class="comment"># https://www.kaggle.com/klyusba/house-prices-advanced-regression-techniques/lasso-model-for-regression-problem/notebook</span></span><br><span class="line"><span class="comment"># https://www.kaggle.com/juliencs/house-prices-advanced-regression-techniques/a-study-on-regression-applied-to-the-ames-dataset/</span></span><br><span class="line"><span class="comment"># https://www.kaggle.com/apapiu/house-prices-advanced-regression-techniques/regularized-linear-models</span></span><br><span class="line"><span class="comment"># but I probably forgot to mention a few. ;-)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># The error metric: RMSE on the log of the sale prices.</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rmse</span>(<span class="params">y_true, y_pred</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sqrt(mean_squared_error(y_true, y_pred))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the data.</span></span><br><span class="line">train_df = pd.read_csv(<span class="string">&quot;/kaggle/input/house-price/train.csv&quot;</span>)</span><br><span class="line">test_df = pd.read_csv(<span class="string">&quot;/kaggle/input/house-price/test.csv&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:02.687146Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:02.686683Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:02.693304Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:02.691322Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:02.687104Z&quot;}” id&#x3D;”iytJVUv-fwK-“ trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#train_df.info()</span></span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code _cell_guid&#x3D;”b1076dfc-b9ad-4769-8c92-a6c4dae69d19” <em>uuid&#x3D;”8f2839f25d086af736a60e9eeb907d3b93b6e0e5” execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:02.696522Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:02.695576Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:02.724609Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:02.723653Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:02.69648Z&quot;}” id&#x3D;”d2utVtJlfwK</em>“ outputId&#x3D;”5dc975c5-9dd2-44b6-de18-4aed3c6af397” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#train_df[&quot;BsmtQual&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line"><span class="comment">#train_df.fillna(&#123;&quot;BsmtQual&quot;: 0&#125;, inplace=True)</span></span><br><span class="line">test_all_df = pd.DataFrame(index = train_df.index)</span><br><span class="line">qual_dict = &#123;np.nan: <span class="number">0</span>,<span class="string">&quot;Po&quot;</span>:<span class="number">1</span>, <span class="string">&quot;Fa&quot;</span>: <span class="number">2</span>, <span class="string">&quot;TA&quot;</span>: <span class="number">3</span>, <span class="string">&quot;Gd&quot;</span>: <span class="number">4</span>, <span class="string">&quot;Ex&quot;</span>: <span class="number">5</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(train_df[<span class="string">&quot;BsmtQual&quot;</span>].unique())</span><br><span class="line"><span class="comment">#test_all_df[&quot;BsmtQual&quot;] =</span></span><br><span class="line">train_df[<span class="string">&quot;BsmtQual&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)</span><br><span class="line"><span class="built_in">print</span>(train_df[<span class="string">&quot;LotArea&quot;</span>].info)</span><br><span class="line"></span><br><span class="line">is_null = train_df[<span class="string">&quot;LotArea&quot;</span>].isnull().<span class="built_in">any</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> is_null:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;BsmtQual 列包含缺失值&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;BsmtQual 列不包含缺失值&quot;</span>)</span><br><span class="line">missing_count = train_df[<span class="string">&quot;LotArea&quot;</span>].isnull().<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;BsmtQual 列中缺失值的数量为:&quot;</span>, missing_count)</span><br><span class="line"></span><br><span class="line"><span class="comment">#train_df.info()</span></span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    [‘Gd’ ‘TA’ ‘Ex’ nan ‘Fa’]<br>    &lt;bound method Series.info of 0        8450<br>    1        9600<br>    2       11250<br>    3        9550<br>    4       14260<br>            …<br>    1455     7917<br>    1456    13175<br>    1457     9042<br>    1458     9717<br>    1459     9937<br>    Name: LotArea, Length: 1460, dtype: int64&gt;<br>    BsmtQual 列不包含缺失值<br>    BsmtQual 列中缺失值的数量为: 0<br>:::<br>:::</p>
<p>::: {.cell .code _cell_guid&#x3D;”b1076dfc-b9ad-4769-8c92-a6c4dae69d19” _uuid&#x3D;”8f2839f25d086af736a60e9eeb907d3b93b6e0e5” execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:02.726668Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:02.725879Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:02.743166Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:02.742048Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:02.726634Z&quot;}” id&#x3D;”u8k8cgaafwLC” outputId&#x3D;”aad16529-d666-4860-e0bc-eab6f9e42278” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># There are a few houses with more than 4000 sq ft living area that are</span></span><br><span class="line"><span class="comment"># outliers, so we drop them from the training data. (There is also one in</span></span><br><span class="line"><span class="comment"># the test set but we obviously can&#x27;t drop that one.)</span></span><br><span class="line">train_df.drop(train_df[train_df[<span class="string">&quot;GrLivArea&quot;</span>] &gt; <span class="number">4000</span>].index, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The test example with ID 666 has GarageArea, GarageCars, and GarageType</span></span><br><span class="line"><span class="comment"># but none of the other fields, so use the mode and median to fill them in.</span></span><br><span class="line">test_df.loc[<span class="number">666</span>, <span class="string">&quot;GarageQual&quot;</span>] = <span class="string">&quot;TA&quot;</span></span><br><span class="line">test_df.loc[<span class="number">666</span>, <span class="string">&quot;GarageCond&quot;</span>] = <span class="string">&quot;TA&quot;</span></span><br><span class="line">test_df.loc[<span class="number">666</span>, <span class="string">&quot;GarageFinish&quot;</span>] = <span class="string">&quot;Unf&quot;</span></span><br><span class="line">test_df.loc[<span class="number">666</span>, <span class="string">&quot;GarageYrBlt&quot;</span>] = <span class="string">&quot;1980&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The test example 1116 only has GarageType but no other information. We&#x27;ll</span></span><br><span class="line"><span class="comment"># assume it does not have a garage.</span></span><br><span class="line">test_df.loc[<span class="number">1116</span>, <span class="string">&quot;GarageType&quot;</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="comment"># For imputing missing values: fill in missing LotFrontage values by the median</span></span><br><span class="line"><span class="comment"># LotFrontage of the neighborhood.</span></span><br><span class="line">lot_frontage_by_neighborhood = train_df[<span class="string">&quot;LotFrontage&quot;</span>].groupby(train_df[<span class="string">&quot;Neighborhood&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;tmp&#x2F;ipykernel_33&#x2F;1245083220.py:11: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value ‘1980’ has dtype incompatible with float64, please explicitly cast to a compatible dtype first.<br>      test_df.loc[666, “GarageYrBlt”] &#x3D; “1980”<br>:::<br>:::</p>
<p>::: {.cell .code _cell_guid&#x3D;”b1076dfc-b9ad-4769-8c92-a6c4dae69d19” _uuid&#x3D;”8f2839f25d086af736a60e9eeb907d3b93b6e0e5” execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:02.746983Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:02.746416Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:03.955791Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:03.954544Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:02.746951Z&quot;}” id&#x3D;”NO_5pBkyfwLD” outputId&#x3D;”86da5209-c4be-4a67-8106-a618350d5dc9” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Used to convert categorical features into ordinal numbers.</span></span><br><span class="line"><span class="comment"># (There&#x27;s probably an easier way to do this, but it works.)</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">le = LabelEncoder()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">df, factor_df, column, fill_na=<span class="literal">None</span></span>):</span><br><span class="line">    factor_df[column] = df[column]</span><br><span class="line">    <span class="keyword">if</span> fill_na <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        factor_df[column].fillna(fill_na, inplace=<span class="literal">True</span>)</span><br><span class="line">    le.fit(factor_df[column].unique())</span><br><span class="line">    factor_df[column] = le.transform(factor_df[column])</span><br><span class="line">    <span class="keyword">return</span> factor_df</span><br><span class="line"></span><br><span class="line"><span class="comment"># Combine all the (numerical) features into one big DataFrame. We don&#x27;t add</span></span><br><span class="line"><span class="comment"># the one-hot encoded variables here yet, that happens later on.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">munge</span>(<span class="params">df</span>):</span><br><span class="line">    all_df = pd.DataFrame(index = df.index)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;LotFrontage&quot;</span>] = df[<span class="string">&quot;LotFrontage&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> key, group <span class="keyword">in</span> lot_frontage_by_neighborhood:</span><br><span class="line">        idx = (df[<span class="string">&quot;Neighborhood&quot;</span>] == key) &amp; (df[<span class="string">&quot;LotFrontage&quot;</span>].isnull())</span><br><span class="line">        all_df.loc[idx, <span class="string">&quot;LotFrontage&quot;</span>] = group.median()</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;LotArea&quot;</span>] = df[<span class="string">&quot;LotArea&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;MasVnrArea&quot;</span>] = df[<span class="string">&quot;MasVnrArea&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;MasVnrArea&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinSF1&quot;</span>] = df[<span class="string">&quot;BsmtFinSF1&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinSF1&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinSF2&quot;</span>] = df[<span class="string">&quot;BsmtFinSF2&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinSF2&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtUnfSF&quot;</span>] = df[<span class="string">&quot;BsmtUnfSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BsmtUnfSF&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;TotalBsmtSF&quot;</span>] = df[<span class="string">&quot;TotalBsmtSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;TotalBsmtSF&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;1stFlrSF&quot;</span>] = df[<span class="string">&quot;1stFlrSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;2ndFlrSF&quot;</span>] = df[<span class="string">&quot;2ndFlrSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;GrLivArea&quot;</span>] = df[<span class="string">&quot;GrLivArea&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;GarageArea&quot;</span>] = df[<span class="string">&quot;GarageArea&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;GarageArea&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;WoodDeckSF&quot;</span>] = df[<span class="string">&quot;WoodDeckSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;OpenPorchSF&quot;</span>] = df[<span class="string">&quot;OpenPorchSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;EnclosedPorch&quot;</span>] = df[<span class="string">&quot;EnclosedPorch&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;3SsnPorch&quot;</span>] = df[<span class="string">&quot;3SsnPorch&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;ScreenPorch&quot;</span>] = df[<span class="string">&quot;ScreenPorch&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtFullBath&quot;</span>] = df[<span class="string">&quot;BsmtFullBath&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BsmtFullBath&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtHalfBath&quot;</span>] = df[<span class="string">&quot;BsmtHalfBath&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BsmtHalfBath&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;FullBath&quot;</span>] = df[<span class="string">&quot;FullBath&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;HalfBath&quot;</span>] = df[<span class="string">&quot;HalfBath&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;BedroomAbvGr&quot;</span>] = df[<span class="string">&quot;BedroomAbvGr&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;KitchenAbvGr&quot;</span>] = df[<span class="string">&quot;KitchenAbvGr&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;TotRmsAbvGrd&quot;</span>] = df[<span class="string">&quot;TotRmsAbvGrd&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;Fireplaces&quot;</span>] = df[<span class="string">&quot;Fireplaces&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;GarageCars&quot;</span>] = df[<span class="string">&quot;GarageCars&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;GarageCars&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;CentralAir&quot;</span>] = (df[<span class="string">&quot;CentralAir&quot;</span>] == <span class="string">&quot;Y&quot;</span>) * <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;OverallQual&quot;</span>] = df[<span class="string">&quot;OverallQual&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;OverallCond&quot;</span>] = df[<span class="string">&quot;OverallCond&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Quality measurements are stored as text but we can convert them to</span></span><br><span class="line">    <span class="comment"># numbers where a higher number means higher quality.</span></span><br><span class="line"></span><br><span class="line">    qual_dict = &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;Po&quot;</span>: <span class="number">1</span>, <span class="string">&quot;Fa&quot;</span>: <span class="number">2</span>, <span class="string">&quot;TA&quot;</span>: <span class="number">3</span>, <span class="string">&quot;Gd&quot;</span>: <span class="number">4</span>, <span class="string">&quot;Ex&quot;</span>: <span class="number">5</span>&#125;</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">   <span class="comment"># qual_dict_sec = &#123;&#x27;NA&#x27;: 0, &quot;Po&quot;: 1, &quot;Fa&quot;: 2, &quot;TA&quot;: 3, &quot;Gd&quot;: 4, &quot;Ex&quot;: 5&#125;</span></span><br><span class="line">   <span class="comment"># df[&quot;BsmtQual&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line">   <span class="comment"># df[&quot;BsmtCond&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line">   <span class="comment"># df[&quot;FireplaceQu&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line">    <span class="comment">#df[&quot;GarageQual&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line">   <span class="comment"># df[&quot;GarageCond&quot;].fillna(&quot;NA&quot;, inplace=True)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    all_df[<span class="string">&quot;ExterQual&quot;</span>] = df[<span class="string">&quot;ExterQual&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)</span><br><span class="line">    all_df[<span class="string">&quot;ExterCond&quot;</span>] = df[<span class="string">&quot;ExterCond&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)</span><br><span class="line">    all_df[<span class="string">&quot;BsmtQual&quot;</span>] = df[<span class="string">&quot;BsmtQual&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line">    all_df[<span class="string">&quot;BsmtCond&quot;</span>] = df[<span class="string">&quot;BsmtCond&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line">    all_df[<span class="string">&quot;HeatingQC&quot;</span>] = df[<span class="string">&quot;HeatingQC&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)</span><br><span class="line">    all_df[<span class="string">&quot;KitchenQual&quot;</span>] = df[<span class="string">&quot;KitchenQual&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)</span><br><span class="line">    all_df[<span class="string">&quot;FireplaceQu&quot;</span>] = df[<span class="string">&quot;FireplaceQu&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line">    all_df[<span class="string">&quot;GarageQual&quot;</span>] = df[<span class="string">&quot;GarageQual&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line">    all_df[<span class="string">&quot;GarageCond&quot;</span>] = df[<span class="string">&quot;GarageCond&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BsmtExposure&quot;</span>] = df[<span class="string">&quot;BsmtExposure&quot;</span>].<span class="built_in">map</span>(</span><br><span class="line">        &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;No&quot;</span>: <span class="number">1</span>, <span class="string">&quot;Mn&quot;</span>: <span class="number">2</span>, <span class="string">&quot;Av&quot;</span>: <span class="number">3</span>, <span class="string">&quot;Gd&quot;</span>: <span class="number">4</span>&#125;).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    bsmt_fin_dict = &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;Unf&quot;</span>: <span class="number">1</span>, <span class="string">&quot;LwQ&quot;</span>: <span class="number">2</span>, <span class="string">&quot;Rec&quot;</span>: <span class="number">3</span>, <span class="string">&quot;BLQ&quot;</span>: <span class="number">4</span>, <span class="string">&quot;ALQ&quot;</span>: <span class="number">5</span>, <span class="string">&quot;GLQ&quot;</span>: <span class="number">6</span>&#125;</span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinType1&quot;</span>] = df[<span class="string">&quot;BsmtFinType1&quot;</span>].<span class="built_in">map</span>(bsmt_fin_dict).astype(<span class="built_in">int</span>)</span><br><span class="line">    all_df[<span class="string">&quot;BsmtFinType2&quot;</span>] = df[<span class="string">&quot;BsmtFinType2&quot;</span>].<span class="built_in">map</span>(bsmt_fin_dict).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;Functional&quot;</span>] = df[<span class="string">&quot;Functional&quot;</span>].<span class="built_in">map</span>(</span><br><span class="line">        &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;Sal&quot;</span>: <span class="number">1</span>, <span class="string">&quot;Sev&quot;</span>: <span class="number">2</span>, <span class="string">&quot;Maj2&quot;</span>: <span class="number">3</span>, <span class="string">&quot;Maj1&quot;</span>: <span class="number">4</span>,</span><br><span class="line">         <span class="string">&quot;Mod&quot;</span>: <span class="number">5</span>, <span class="string">&quot;Min2&quot;</span>: <span class="number">6</span>, <span class="string">&quot;Min1&quot;</span>: <span class="number">7</span>, <span class="string">&quot;Typ&quot;</span>: <span class="number">8</span>&#125;).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;GarageFinish&quot;</span>] = df[<span class="string">&quot;GarageFinish&quot;</span>].<span class="built_in">map</span>(</span><br><span class="line">        &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;Unf&quot;</span>: <span class="number">1</span>, <span class="string">&quot;RFn&quot;</span>: <span class="number">2</span>, <span class="string">&quot;Fin&quot;</span>: <span class="number">3</span>&#125;).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;Fence&quot;</span>] = df[<span class="string">&quot;Fence&quot;</span>].<span class="built_in">map</span>(</span><br><span class="line">        &#123;np.nan: <span class="number">0</span>, <span class="string">&quot;MnWw&quot;</span>: <span class="number">1</span>, <span class="string">&quot;GdWo&quot;</span>: <span class="number">2</span>, <span class="string">&quot;MnPrv&quot;</span>: <span class="number">3</span>, <span class="string">&quot;GdPrv&quot;</span>: <span class="number">4</span>&#125;).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;YearBuilt&quot;</span>] = df[<span class="string">&quot;YearBuilt&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;YearRemodAdd&quot;</span>] = df[<span class="string">&quot;YearRemodAdd&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;GarageYrBlt&quot;</span>] = df[<span class="string">&quot;GarageYrBlt&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;GarageYrBlt&quot;</span>].fillna(<span class="number">0.0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;MoSold&quot;</span>] = df[<span class="string">&quot;MoSold&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;YrSold&quot;</span>] = df[<span class="string">&quot;YrSold&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;LowQualFinSF&quot;</span>] = df[<span class="string">&quot;LowQualFinSF&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;MiscVal&quot;</span>] = df[<span class="string">&quot;MiscVal&quot;</span>]</span><br><span class="line"></span><br><span class="line">   <span class="comment"># df[&quot;PoolQC&quot;].fillna(&quot;NA&quot;, inplace=True) #</span></span><br><span class="line">    all_df[<span class="string">&quot;PoolQC&quot;</span>] = df[<span class="string">&quot;PoolQC&quot;</span>].<span class="built_in">map</span>(qual_dict).astype(<span class="built_in">int</span>)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;PoolArea&quot;</span>] = df[<span class="string">&quot;PoolArea&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;PoolArea&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add categorical features as numbers too. It seems to help a bit.</span></span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;MSSubClass&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;MSZoning&quot;</span>, <span class="string">&quot;RL&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;LotConfig&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;Neighborhood&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;Condition1&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;BldgType&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;HouseStyle&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;RoofStyle&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;Exterior1st&quot;</span>, <span class="string">&quot;Other&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;Exterior2nd&quot;</span>, <span class="string">&quot;Other&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;MasVnrType&quot;</span>, <span class="string">&quot;None&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;Foundation&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;SaleType&quot;</span>, <span class="string">&quot;Oth&quot;</span>)</span><br><span class="line">    all_df = factorize(df, all_df, <span class="string">&quot;SaleCondition&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># IR2 and IR3 don&#x27;t appear that often, so just make a distinction</span></span><br><span class="line">    <span class="comment"># between regular and irregular.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsRegularLotShape&quot;</span>] = (df[<span class="string">&quot;LotShape&quot;</span>] == <span class="string">&quot;Reg&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Most properties are level; bin the other possibilities together</span></span><br><span class="line">    <span class="comment"># as &quot;not level&quot;.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsLandLevel&quot;</span>] = (df[<span class="string">&quot;LandContour&quot;</span>] == <span class="string">&quot;Lvl&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Most land slopes are gentle; treat the others as &quot;not gentle&quot;.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsLandSlopeGentle&quot;</span>] = (df[<span class="string">&quot;LandSlope&quot;</span>] == <span class="string">&quot;Gtl&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Most properties use standard circuit breakers.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsElectricalSBrkr&quot;</span>] = (df[<span class="string">&quot;Electrical&quot;</span>] == <span class="string">&quot;SBrkr&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># About 2/3rd have an attached garage.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsGarageDetached&quot;</span>] = (df[<span class="string">&quot;GarageType&quot;</span>] == <span class="string">&quot;Detchd&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Most have a paved drive. Treat dirt/gravel and partial pavement</span></span><br><span class="line">    <span class="comment"># as &quot;not paved&quot;.</span></span><br><span class="line">    all_df[<span class="string">&quot;IsPavedDrive&quot;</span>] = (df[<span class="string">&quot;PavedDrive&quot;</span>] == <span class="string">&quot;Y&quot;</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># The only interesting &quot;misc. feature&quot; is the presence of a shed.</span></span><br><span class="line">    all_df[<span class="string">&quot;HasShed&quot;</span>] = (df[<span class="string">&quot;MiscFeature&quot;</span>] == <span class="string">&quot;Shed&quot;</span>) * <span class="number">1.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># If YearRemodAdd != YearBuilt, then a remodeling took place at some point.</span></span><br><span class="line">    all_df[<span class="string">&quot;Remodeled&quot;</span>] = (all_df[<span class="string">&quot;YearRemodAdd&quot;</span>] != all_df[<span class="string">&quot;YearBuilt&quot;</span>]) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Did a remodeling happen in the year the house was sold?</span></span><br><span class="line">    all_df[<span class="string">&quot;RecentRemodel&quot;</span>] = (all_df[<span class="string">&quot;YearRemodAdd&quot;</span>] == all_df[<span class="string">&quot;YrSold&quot;</span>]) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Was this house sold in the year it was built?</span></span><br><span class="line">    all_df[<span class="string">&quot;VeryNewHouse&quot;</span>] = (all_df[<span class="string">&quot;YearBuilt&quot;</span>] == all_df[<span class="string">&quot;YrSold&quot;</span>]) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;Has2ndFloor&quot;</span>] = (all_df[<span class="string">&quot;2ndFlrSF&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;HasMasVnr&quot;</span>] = (all_df[<span class="string">&quot;MasVnrArea&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;HasWoodDeck&quot;</span>] = (all_df[<span class="string">&quot;WoodDeckSF&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;HasOpenPorch&quot;</span>] = (all_df[<span class="string">&quot;OpenPorchSF&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;HasEnclosedPorch&quot;</span>] = (all_df[<span class="string">&quot;EnclosedPorch&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;Has3SsnPorch&quot;</span>] = (all_df[<span class="string">&quot;3SsnPorch&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;HasScreenPorch&quot;</span>] = (all_df[<span class="string">&quot;ScreenPorch&quot;</span>] == <span class="number">0</span>) * <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># These features actually lower the score a little.</span></span><br><span class="line">    <span class="comment"># all_df[&quot;HasBasement&quot;] = df[&quot;BsmtQual&quot;].isnull() * 1</span></span><br><span class="line">    <span class="comment"># all_df[&quot;HasGarage&quot;] = df[&quot;GarageQual&quot;].isnull() * 1</span></span><br><span class="line">    <span class="comment"># all_df[&quot;HasFireplace&quot;] = df[&quot;FireplaceQu&quot;].isnull() * 1</span></span><br><span class="line">    <span class="comment"># all_df[&quot;HasFence&quot;] = df[&quot;Fence&quot;].isnull() * 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Months with the largest number of deals may be significant.</span></span><br><span class="line">    all_df[<span class="string">&quot;HighSeason&quot;</span>] = df[<span class="string">&quot;MoSold&quot;</span>].replace(</span><br><span class="line">        &#123;<span class="number">1</span>: <span class="number">0</span>, <span class="number">2</span>: <span class="number">0</span>, <span class="number">3</span>: <span class="number">0</span>, <span class="number">4</span>: <span class="number">1</span>, <span class="number">5</span>: <span class="number">1</span>, <span class="number">6</span>: <span class="number">1</span>, <span class="number">7</span>: <span class="number">1</span>, <span class="number">8</span>: <span class="number">0</span>, <span class="number">9</span>: <span class="number">0</span>, <span class="number">10</span>: <span class="number">0</span>, <span class="number">11</span>: <span class="number">0</span>, <span class="number">12</span>: <span class="number">0</span>&#125;)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;NewerDwelling&quot;</span>] = df[<span class="string">&quot;MSSubClass&quot;</span>].replace(</span><br><span class="line">        &#123;<span class="number">20</span>: <span class="number">1</span>, <span class="number">30</span>: <span class="number">0</span>, <span class="number">40</span>: <span class="number">0</span>, <span class="number">45</span>: <span class="number">0</span>,<span class="number">50</span>: <span class="number">0</span>, <span class="number">60</span>: <span class="number">1</span>, <span class="number">70</span>: <span class="number">0</span>, <span class="number">75</span>: <span class="number">0</span>, <span class="number">80</span>: <span class="number">0</span>, <span class="number">85</span>: <span class="number">0</span>,</span><br><span class="line">         <span class="number">90</span>: <span class="number">0</span>, <span class="number">120</span>: <span class="number">1</span>, <span class="number">150</span>: <span class="number">0</span>, <span class="number">160</span>: <span class="number">0</span>, <span class="number">180</span>: <span class="number">0</span>, <span class="number">190</span>: <span class="number">0</span>&#125;)</span><br><span class="line"></span><br><span class="line">    all_df.loc[df.Neighborhood == <span class="string">&#x27;NridgHt&#x27;</span>, <span class="string">&quot;Neighborhood_Good&quot;</span>] = <span class="number">1</span></span><br><span class="line">    all_df.loc[df.Neighborhood == <span class="string">&#x27;Crawfor&#x27;</span>, <span class="string">&quot;Neighborhood_Good&quot;</span>] = <span class="number">1</span></span><br><span class="line">    all_df.loc[df.Neighborhood == <span class="string">&#x27;StoneBr&#x27;</span>, <span class="string">&quot;Neighborhood_Good&quot;</span>] = <span class="number">1</span></span><br><span class="line">    all_df.loc[df.Neighborhood == <span class="string">&#x27;Somerst&#x27;</span>, <span class="string">&quot;Neighborhood_Good&quot;</span>] = <span class="number">1</span></span><br><span class="line">    all_df.loc[df.Neighborhood == <span class="string">&#x27;NoRidge&#x27;</span>, <span class="string">&quot;Neighborhood_Good&quot;</span>] = <span class="number">1</span></span><br><span class="line">    all_df[<span class="string">&quot;Neighborhood_Good&quot;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;SaleCondition_PriceDown&quot;</span>] = df.SaleCondition.replace(</span><br><span class="line">        &#123;<span class="string">&#x27;Abnorml&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;Alloca&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;AdjLand&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;Family&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;Normal&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;Partial&#x27;</span>: <span class="number">0</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># House completed before sale or not</span></span><br><span class="line">    all_df[<span class="string">&quot;BoughtOffPlan&quot;</span>] = df.SaleCondition.replace(</span><br><span class="line">        &#123;<span class="string">&quot;Abnorml&quot;</span> : <span class="number">0</span>, <span class="string">&quot;Alloca&quot;</span> : <span class="number">0</span>, <span class="string">&quot;AdjLand&quot;</span> : <span class="number">0</span>, <span class="string">&quot;Family&quot;</span> : <span class="number">0</span>, <span class="string">&quot;Normal&quot;</span> : <span class="number">0</span>, <span class="string">&quot;Partial&quot;</span> : <span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;BadHeating&quot;</span>] = df.HeatingQC.replace(</span><br><span class="line">        &#123;<span class="string">&#x27;Ex&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;Gd&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;TA&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;Fa&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;Po&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line">    area_cols = [<span class="string">&#x27;LotFrontage&#x27;</span>, <span class="string">&#x27;LotArea&#x27;</span>, <span class="string">&#x27;MasVnrArea&#x27;</span>, <span class="string">&#x27;BsmtFinSF1&#x27;</span>, <span class="string">&#x27;BsmtFinSF2&#x27;</span>, <span class="string">&#x27;BsmtUnfSF&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;TotalBsmtSF&#x27;</span>, <span class="string">&#x27;1stFlrSF&#x27;</span>, <span class="string">&#x27;2ndFlrSF&#x27;</span>, <span class="string">&#x27;GrLivArea&#x27;</span>, <span class="string">&#x27;GarageArea&#x27;</span>, <span class="string">&#x27;WoodDeckSF&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;OpenPorchSF&#x27;</span>, <span class="string">&#x27;EnclosedPorch&#x27;</span>, <span class="string">&#x27;3SsnPorch&#x27;</span>, <span class="string">&#x27;ScreenPorch&#x27;</span>, <span class="string">&#x27;LowQualFinSF&#x27;</span>, <span class="string">&#x27;PoolArea&#x27;</span> ]</span><br><span class="line">    all_df[<span class="string">&quot;TotalArea&quot;</span>] = all_df[area_cols].<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;TotalArea1st2nd&quot;</span>] = all_df[<span class="string">&quot;1stFlrSF&quot;</span>] + all_df[<span class="string">&quot;2ndFlrSF&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;Age&quot;</span>] = <span class="number">2010</span> - all_df[<span class="string">&quot;YearBuilt&quot;</span>]</span><br><span class="line">    all_df[<span class="string">&quot;TimeSinceSold&quot;</span>] = <span class="number">2010</span> - all_df[<span class="string">&quot;YrSold&quot;</span>]</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;SeasonSold&quot;</span>] = all_df[<span class="string">&quot;MoSold&quot;</span>].<span class="built_in">map</span>(&#123;<span class="number">12</span>:<span class="number">0</span>, <span class="number">1</span>:<span class="number">0</span>, <span class="number">2</span>:<span class="number">0</span>, <span class="number">3</span>:<span class="number">1</span>, <span class="number">4</span>:<span class="number">1</span>, <span class="number">5</span>:<span class="number">1</span>,</span><br><span class="line">                                                  <span class="number">6</span>:<span class="number">2</span>, <span class="number">7</span>:<span class="number">2</span>, <span class="number">8</span>:<span class="number">2</span>, <span class="number">9</span>:<span class="number">3</span>, <span class="number">10</span>:<span class="number">3</span>, <span class="number">11</span>:<span class="number">3</span>&#125;).astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;YearsSinceRemodel&quot;</span>] = all_df[<span class="string">&quot;YrSold&quot;</span>] - all_df[<span class="string">&quot;YearRemodAdd&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Simplifications of existing features into bad/average/good.</span></span><br><span class="line">    all_df[<span class="string">&quot;SimplOverallQual&quot;</span>] = all_df.OverallQual.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>, <span class="number">6</span> : <span class="number">2</span>, <span class="number">7</span> : <span class="number">3</span>, <span class="number">8</span> : <span class="number">3</span>, <span class="number">9</span> : <span class="number">3</span>, <span class="number">10</span> : <span class="number">3</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplOverallCond&quot;</span>] = all_df.OverallCond.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>, <span class="number">6</span> : <span class="number">2</span>, <span class="number">7</span> : <span class="number">3</span>, <span class="number">8</span> : <span class="number">3</span>, <span class="number">9</span> : <span class="number">3</span>, <span class="number">10</span> : <span class="number">3</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplPoolQC&quot;</span>] = all_df.PoolQC.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">2</span>, <span class="number">4</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplGarageCond&quot;</span>] = all_df.GarageCond.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplGarageQual&quot;</span>] = all_df.GarageQual.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplFireplaceQu&quot;</span>] = all_df.FireplaceQu.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplFireplaceQu&quot;</span>] = all_df.FireplaceQu.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplFunctional&quot;</span>] = all_df.Functional.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">2</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">3</span>, <span class="number">6</span> : <span class="number">3</span>, <span class="number">7</span> : <span class="number">3</span>, <span class="number">8</span> : <span class="number">4</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplKitchenQual&quot;</span>] = all_df.KitchenQual.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplHeatingQC&quot;</span>] = all_df.HeatingQC.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplBsmtFinType1&quot;</span>] = all_df.BsmtFinType1.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>, <span class="number">6</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplBsmtFinType2&quot;</span>] = all_df.BsmtFinType2.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>, <span class="number">6</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplBsmtCond&quot;</span>] = all_df.BsmtCond.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplBsmtQual&quot;</span>] = all_df.BsmtQual.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplExterCond&quot;</span>] = all_df.ExterCond.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line">    all_df[<span class="string">&quot;SimplExterQual&quot;</span>] = all_df.ExterQual.replace(</span><br><span class="line">        &#123;<span class="number">1</span> : <span class="number">1</span>, <span class="number">2</span> : <span class="number">1</span>, <span class="number">3</span> : <span class="number">1</span>, <span class="number">4</span> : <span class="number">2</span>, <span class="number">5</span> : <span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Bin by neighborhood (a little arbitrarily). Values were computed by:</span></span><br><span class="line">    <span class="comment"># train_df[&quot;SalePrice&quot;].groupby(train_df[&quot;Neighborhood&quot;]).median().sort_values()</span></span><br><span class="line">    neighborhood_map = &#123;</span><br><span class="line">        <span class="string">&quot;MeadowV&quot;</span> : <span class="number">0</span>,  <span class="comment">#  88000</span></span><br><span class="line">        <span class="string">&quot;IDOTRR&quot;</span> : <span class="number">1</span>,   <span class="comment"># 103000</span></span><br><span class="line">        <span class="string">&quot;BrDale&quot;</span> : <span class="number">1</span>,   <span class="comment"># 106000</span></span><br><span class="line">        <span class="string">&quot;OldTown&quot;</span> : <span class="number">1</span>,  <span class="comment"># 119000</span></span><br><span class="line">        <span class="string">&quot;Edwards&quot;</span> : <span class="number">1</span>,  <span class="comment"># 119500</span></span><br><span class="line">        <span class="string">&quot;BrkSide&quot;</span> : <span class="number">1</span>,  <span class="comment"># 124300</span></span><br><span class="line">        <span class="string">&quot;Sawyer&quot;</span> : <span class="number">1</span>,   <span class="comment"># 135000</span></span><br><span class="line">        <span class="string">&quot;Blueste&quot;</span> : <span class="number">1</span>,  <span class="comment"># 137500</span></span><br><span class="line">        <span class="string">&quot;SWISU&quot;</span> : <span class="number">2</span>,    <span class="comment"># 139500</span></span><br><span class="line">        <span class="string">&quot;NAmes&quot;</span> : <span class="number">2</span>,    <span class="comment"># 140000</span></span><br><span class="line">        <span class="string">&quot;NPkVill&quot;</span> : <span class="number">2</span>,  <span class="comment"># 146000</span></span><br><span class="line">        <span class="string">&quot;Mitchel&quot;</span> : <span class="number">2</span>,  <span class="comment"># 153500</span></span><br><span class="line">        <span class="string">&quot;SawyerW&quot;</span> : <span class="number">2</span>,  <span class="comment"># 179900</span></span><br><span class="line">        <span class="string">&quot;Gilbert&quot;</span> : <span class="number">2</span>,  <span class="comment"># 181000</span></span><br><span class="line">        <span class="string">&quot;NWAmes&quot;</span> : <span class="number">2</span>,   <span class="comment"># 182900</span></span><br><span class="line">        <span class="string">&quot;Blmngtn&quot;</span> : <span class="number">2</span>,  <span class="comment"># 191000</span></span><br><span class="line">        <span class="string">&quot;CollgCr&quot;</span> : <span class="number">2</span>,  <span class="comment"># 197200</span></span><br><span class="line">        <span class="string">&quot;ClearCr&quot;</span> : <span class="number">3</span>,  <span class="comment"># 200250</span></span><br><span class="line">        <span class="string">&quot;Crawfor&quot;</span> : <span class="number">3</span>,  <span class="comment"># 200624</span></span><br><span class="line">        <span class="string">&quot;Veenker&quot;</span> : <span class="number">3</span>,  <span class="comment"># 218000</span></span><br><span class="line">        <span class="string">&quot;Somerst&quot;</span> : <span class="number">3</span>,  <span class="comment"># 225500</span></span><br><span class="line">        <span class="string">&quot;Timber&quot;</span> : <span class="number">3</span>,   <span class="comment"># 228475</span></span><br><span class="line">        <span class="string">&quot;StoneBr&quot;</span> : <span class="number">4</span>,  <span class="comment"># 278000</span></span><br><span class="line">        <span class="string">&quot;NoRidge&quot;</span> : <span class="number">4</span>,  <span class="comment"># 290000</span></span><br><span class="line">        <span class="string">&quot;NridgHt&quot;</span> : <span class="number">4</span>,  <span class="comment"># 315000</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    all_df[<span class="string">&quot;NeighborhoodBin&quot;</span>] = df[<span class="string">&quot;Neighborhood&quot;</span>].<span class="built_in">map</span>(neighborhood_map)</span><br><span class="line">    <span class="keyword">return</span> all_df</span><br><span class="line"></span><br><span class="line">train_df_munged = munge(train_df)</span><br><span class="line">test_df_munged = munge(test_df)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(train_df_munged.shape)</span><br><span class="line"><span class="built_in">print</span>(test_df_munged.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy NeighborhoodBin into a temporary DataFrame because we want to use the</span></span><br><span class="line"><span class="comment"># unscaled version later on (to one-hot encode it).</span></span><br><span class="line">neighborhood_bin_train = pd.DataFrame(index = train_df.index)</span><br><span class="line">neighborhood_bin_train[<span class="string">&quot;NeighborhoodBin&quot;</span>] = train_df_munged[<span class="string">&quot;NeighborhoodBin&quot;</span>]</span><br><span class="line">neighborhood_bin_test = pd.DataFrame(index = test_df.index)</span><br><span class="line">neighborhood_bin_test[<span class="string">&quot;NeighborhoodBin&quot;</span>] = test_df_munged[<span class="string">&quot;NeighborhoodBin&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line">numeric_features = train_df_munged.dtypes[train_df_munged.dtypes != <span class="string">&quot;object&quot;</span>].index</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transform the skewed numeric features by taking log(feature + 1).</span></span><br><span class="line"><span class="comment"># This will make the features more normal.</span></span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> skew</span><br><span class="line"></span><br><span class="line">skewed = train_df_munged[numeric_features].apply(<span class="keyword">lambda</span> x: skew(x.dropna().astype(<span class="built_in">float</span>)))</span><br><span class="line">skewed = skewed[skewed &gt; <span class="number">0.75</span>]</span><br><span class="line">skewed = skewed.index</span><br><span class="line"></span><br><span class="line">train_df_munged[skewed] = np.log1p(train_df_munged[skewed])</span><br><span class="line">test_df_munged[skewed] = np.log1p(test_df_munged[skewed])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Additional processing: scale the data.</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">scaler.fit(train_df_munged[numeric_features])</span><br><span class="line"></span><br><span class="line">scaled = scaler.transform(train_df_munged[numeric_features])</span><br><span class="line"><span class="keyword">for</span> i, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(numeric_features):</span><br><span class="line">    train_df_munged[col] = scaled[:, i]</span><br><span class="line"></span><br><span class="line">scaled = scaler.transform(test_df_munged[numeric_features])</span><br><span class="line"><span class="keyword">for</span> i, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(numeric_features):</span><br><span class="line">    test_df_munged[col] = scaled[:, i]</span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert categorical features using one-hot encoding.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">onehot</span>(<span class="params">onehot_df, df, column_name, fill_na, drop_name</span>):</span><br><span class="line">    onehot_df[column_name] = df[column_name]</span><br><span class="line">    <span class="keyword">if</span> fill_na <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        onehot_df[column_name].fillna(fill_na, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    dummies = pd.get_dummies(onehot_df[column_name], prefix=<span class="string">&quot;_&quot;</span> + column_name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Dropping one of the columns actually made the results slightly worse.</span></span><br><span class="line">    <span class="comment"># if drop_name is not None:</span></span><br><span class="line">    <span class="comment">#     dummies.drop([&quot;_&quot; + column_name + &quot;_&quot; + drop_name], axis=1, inplace=True)</span></span><br><span class="line"></span><br><span class="line">    onehot_df = onehot_df.join(dummies)</span><br><span class="line">    onehot_df = onehot_df.drop([column_name], axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> onehot_df</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">munge_onehot</span>(<span class="params">df</span>):</span><br><span class="line">    onehot_df = pd.DataFrame(index = df.index)</span><br><span class="line"></span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;MSSubClass&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;40&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;MSZoning&quot;</span>, <span class="string">&quot;RL&quot;</span>, <span class="string">&quot;RH&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;LotConfig&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;FR3&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Neighborhood&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;OldTown&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Condition1&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;RRNe&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BldgType&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;2fmCon&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;HouseStyle&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;1.5Unf&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;RoofStyle&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Shed&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Exterior1st&quot;</span>, <span class="string">&quot;VinylSd&quot;</span>, <span class="string">&quot;CBlock&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Exterior2nd&quot;</span>, <span class="string">&quot;VinylSd&quot;</span>, <span class="string">&quot;CBlock&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Foundation&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Wood&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;SaleType&quot;</span>, <span class="string">&quot;WD&quot;</span>, <span class="string">&quot;Oth&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;SaleCondition&quot;</span>, <span class="string">&quot;Normal&quot;</span>, <span class="string">&quot;AdjLand&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Fill in missing MasVnrType for rows that do have a MasVnrArea.</span></span><br><span class="line">    temp_df = df[[<span class="string">&quot;MasVnrType&quot;</span>, <span class="string">&quot;MasVnrArea&quot;</span>]].copy()</span><br><span class="line">    idx = (df[<span class="string">&quot;MasVnrArea&quot;</span>] != <span class="number">0</span>) &amp; ((df[<span class="string">&quot;MasVnrType&quot;</span>] == <span class="string">&quot;None&quot;</span>) | (df[<span class="string">&quot;MasVnrType&quot;</span>].isnull()))</span><br><span class="line">    temp_df.loc[idx, <span class="string">&quot;MasVnrType&quot;</span>] = <span class="string">&quot;BrkFace&quot;</span></span><br><span class="line">    onehot_df = onehot(onehot_df, temp_df, <span class="string">&quot;MasVnrType&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;BrkCmn&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Also add the booleans from calc_df as dummy variables.</span></span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;LotShape&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;IR3&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;LandContour&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Low&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;LandSlope&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Sev&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Electrical&quot;</span>, <span class="string">&quot;SBrkr&quot;</span>, <span class="string">&quot;FuseP&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;GarageType&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;CarPort&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;PavedDrive&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;P&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;MiscFeature&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Othr&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Features we can probably ignore (but want to include anyway to see</span></span><br><span class="line">    <span class="comment"># if they make any positive difference).</span></span><br><span class="line">    <span class="comment"># Definitely ignoring Utilities: all records are &quot;AllPub&quot;, except for</span></span><br><span class="line">    <span class="comment"># one &quot;NoSeWa&quot; in the train set and 2 NA in the test set.</span></span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Street&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Grvl&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Alley&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Grvl&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Condition2&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;PosA&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;RoofMatl&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;WdShake&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Heating&quot;</span>, <span class="literal">None</span>, <span class="string">&quot;Wall&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># I have these as numerical variables too.</span></span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;ExterQual&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;ExterCond&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BsmtQual&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BsmtCond&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;HeatingQC&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;KitchenQual&quot;</span>, <span class="string">&quot;TA&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;FireplaceQu&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;GarageQual&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;GarageCond&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;PoolQC&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Ex&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BsmtExposure&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Gd&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BsmtFinType1&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;GLQ&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;BsmtFinType2&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;GLQ&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Functional&quot;</span>, <span class="string">&quot;Typ&quot;</span>, <span class="string">&quot;Typ&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;GarageFinish&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;Fin&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;Fence&quot;</span>, <span class="string">&quot;None&quot;</span>, <span class="string">&quot;MnPrv&quot;</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, df, <span class="string">&quot;MoSold&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Divide up the years between 1871 and 2010 in slices of 20 years.</span></span><br><span class="line">    year_map = pd.concat(pd.Series(<span class="string">&quot;YearBin&quot;</span> + <span class="built_in">str</span>(i+<span class="number">1</span>), index=<span class="built_in">range</span>(<span class="number">1871</span>+i*<span class="number">20</span>,<span class="number">1891</span>+i*<span class="number">20</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">    yearbin_df = pd.DataFrame(index = df.index)</span><br><span class="line">    yearbin_df[<span class="string">&quot;GarageYrBltBin&quot;</span>] = df.GarageYrBlt.<span class="built_in">map</span>(year_map)</span><br><span class="line">    yearbin_df[<span class="string">&quot;GarageYrBltBin&quot;</span>].fillna(<span class="string">&quot;NoGarage&quot;</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    yearbin_df[<span class="string">&quot;YearBuiltBin&quot;</span>] = df.YearBuilt.<span class="built_in">map</span>(year_map)</span><br><span class="line">    yearbin_df[<span class="string">&quot;YearRemodAddBin&quot;</span>] = df.YearRemodAdd.<span class="built_in">map</span>(year_map)</span><br><span class="line"></span><br><span class="line">    onehot_df = onehot(onehot_df, yearbin_df, <span class="string">&quot;GarageYrBltBin&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, yearbin_df, <span class="string">&quot;YearBuiltBin&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">    onehot_df = onehot(onehot_df, yearbin_df, <span class="string">&quot;YearRemodAddBin&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> onehot_df</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the one-hot encoded categorical features.</span></span><br><span class="line">onehot_df = munge_onehot(train_df)</span><br><span class="line">onehot_df = onehot(onehot_df, neighborhood_bin_train, <span class="string">&quot;NeighborhoodBin&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">train_df_munged = train_df_munged.join(onehot_df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># These onehot columns are missing in the test data, so drop them from the</span></span><br><span class="line"><span class="comment"># training data or we might overfit on them.</span></span><br><span class="line">drop_cols = [</span><br><span class="line">                <span class="string">&quot;_Exterior1st_ImStucc&quot;</span>, <span class="string">&quot;_Exterior1st_Stone&quot;</span>,</span><br><span class="line">                <span class="string">&quot;_Exterior2nd_Other&quot;</span>,<span class="string">&quot;_HouseStyle_2.5Fin&quot;</span>,</span><br><span class="line"></span><br><span class="line">                <span class="string">&quot;_RoofMatl_Membran&quot;</span>, <span class="string">&quot;_RoofMatl_Metal&quot;</span>, <span class="string">&quot;_RoofMatl_Roll&quot;</span>,</span><br><span class="line">                <span class="string">&quot;_Condition2_RRAe&quot;</span>, <span class="string">&quot;_Condition2_RRAn&quot;</span>, <span class="string">&quot;_Condition2_RRNn&quot;</span>,</span><br><span class="line">                <span class="string">&quot;_Heating_Floor&quot;</span>, <span class="string">&quot;_Heating_OthW&quot;</span>,</span><br><span class="line"></span><br><span class="line">                <span class="string">&quot;_Electrical_Mix&quot;</span>,</span><br><span class="line">                <span class="string">&quot;_MiscFeature_TenC&quot;</span>,</span><br><span class="line">                <span class="string">&quot;_GarageQual_Ex&quot;</span>, <span class="string">&quot;_PoolQC_Fa&quot;</span></span><br><span class="line">            ]</span><br><span class="line">train_df_munged.drop(drop_cols, axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">onehot_df = munge_onehot(test_df)</span><br><span class="line">onehot_df = onehot(onehot_df, neighborhood_bin_test, <span class="string">&quot;NeighborhoodBin&quot;</span>, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">test_df_munged = test_df_munged.join(onehot_df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This column is missing in the training data. There is only one example with</span></span><br><span class="line"><span class="comment"># this value in the test set. So just drop it.</span></span><br><span class="line">test_df_munged.drop([<span class="string">&quot;_MSSubClass_150&quot;</span>], axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Drop these columns. They are either not very helpful or they cause overfitting.</span></span><br><span class="line">drop_cols = [</span><br><span class="line">    <span class="string">&quot;_Condition2_PosN&quot;</span>,    <span class="comment"># only two are not zero</span></span><br><span class="line">    <span class="string">&quot;_MSZoning_C (all)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;_MSSubClass_160&quot;</span>,</span><br><span class="line">]</span><br><span class="line">train_df_munged.drop(drop_cols, axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">test_df_munged.drop(drop_cols, axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># We take the log here because the error metric is between the log of the</span></span><br><span class="line"><span class="comment"># SalePrice and the log of the predicted price. That does mean we need to</span></span><br><span class="line"><span class="comment"># exp() the prediction to get an actual sale price.</span></span><br><span class="line">label_df = pd.DataFrame(index = train_df_munged.index, columns=[<span class="string">&quot;SalePrice&quot;</span>])</span><br><span class="line">label_df[<span class="string">&quot;SalePrice&quot;</span>] = np.log(train_df[<span class="string">&quot;SalePrice&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Training set size:&quot;</span>, train_df_munged.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test set size:&quot;</span>, test_df_munged.shape)</span><br><span class="line">y_train = label_df[<span class="string">&quot;SalePrice&quot;</span>].values</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;tmp&#x2F;ipykernel_33&#x2F;881269123.py:27: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.<br>    The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.</p>
<pre><code>For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;MasVnrArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:30: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFinSF1&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:33: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFinSF2&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:36: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtUnfSF&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:39: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;TotalBsmtSF&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:46: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:55: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFullBath&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:58: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtHalfBath&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:68: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageCars&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:118: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageYrBlt&quot;].fillna(0.0, inplace=True)
/tmp/ipykernel_33/881269123.py:130: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;PoolArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:208: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;Neighborhood_Good&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:210: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;SaleCondition_PriceDown&quot;] = df.SaleCondition.replace(
/tmp/ipykernel_33/881269123.py:214: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;BoughtOffPlan&quot;] = df.SaleCondition.replace(
/tmp/ipykernel_33/881269123.py:217: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;BadHeating&quot;] = df.HeatingQC.replace(
/tmp/ipykernel_33/881269123.py:246: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplFireplaceQu&quot;] = all_df.FireplaceQu.replace(
/tmp/ipykernel_33/881269123.py:250: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplFunctional&quot;] = all_df.Functional.replace(
/tmp/ipykernel_33/881269123.py:252: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplKitchenQual&quot;] = all_df.KitchenQual.replace(
/tmp/ipykernel_33/881269123.py:254: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplHeatingQC&quot;] = all_df.HeatingQC.replace(
/tmp/ipykernel_33/881269123.py:256: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtFinType1&quot;] = all_df.BsmtFinType1.replace(
/tmp/ipykernel_33/881269123.py:258: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtFinType2&quot;] = all_df.BsmtFinType2.replace(
/tmp/ipykernel_33/881269123.py:260: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtCond&quot;] = all_df.BsmtCond.replace(
/tmp/ipykernel_33/881269123.py:262: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtQual&quot;] = all_df.BsmtQual.replace(
/tmp/ipykernel_33/881269123.py:264: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplExterCond&quot;] = all_df.ExterCond.replace(
/tmp/ipykernel_33/881269123.py:266: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplExterQual&quot;] = all_df.ExterQual.replace(
/tmp/ipykernel_33/881269123.py:299: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;NeighborhoodBin&quot;] = df[&quot;Neighborhood&quot;].map(neighborhood_map)
/tmp/ipykernel_33/881269123.py:27: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;MasVnrArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:30: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFinSF1&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:33: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFinSF2&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:36: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtUnfSF&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:39: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;TotalBsmtSF&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:46: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:55: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtFullBath&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:58: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;BsmtHalfBath&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:68: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageCars&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:118: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;GarageYrBlt&quot;].fillna(0.0, inplace=True)
/tmp/ipykernel_33/881269123.py:130: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;PoolArea&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:9: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  factor_df[column].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:208: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  all_df[&quot;Neighborhood_Good&quot;].fillna(0, inplace=True)
/tmp/ipykernel_33/881269123.py:210: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;SaleCondition_PriceDown&quot;] = df.SaleCondition.replace(
/tmp/ipykernel_33/881269123.py:214: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;BoughtOffPlan&quot;] = df.SaleCondition.replace(
/tmp/ipykernel_33/881269123.py:217: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  all_df[&quot;BadHeating&quot;] = df.HeatingQC.replace(
/tmp/ipykernel_33/881269123.py:246: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplFireplaceQu&quot;] = all_df.FireplaceQu.replace(
/tmp/ipykernel_33/881269123.py:250: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplFunctional&quot;] = all_df.Functional.replace(
/tmp/ipykernel_33/881269123.py:252: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplKitchenQual&quot;] = all_df.KitchenQual.replace(
/tmp/ipykernel_33/881269123.py:254: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplHeatingQC&quot;] = all_df.HeatingQC.replace(
/tmp/ipykernel_33/881269123.py:256: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtFinType1&quot;] = all_df.BsmtFinType1.replace(
/tmp/ipykernel_33/881269123.py:258: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtFinType2&quot;] = all_df.BsmtFinType2.replace(
/tmp/ipykernel_33/881269123.py:260: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtCond&quot;] = all_df.BsmtCond.replace(
/tmp/ipykernel_33/881269123.py:262: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplBsmtQual&quot;] = all_df.BsmtQual.replace(
/tmp/ipykernel_33/881269123.py:264: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplExterCond&quot;] = all_df.ExterCond.replace(
/tmp/ipykernel_33/881269123.py:266: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;SimplExterQual&quot;] = all_df.ExterQual.replace(
/tmp/ipykernel_33/881269123.py:299: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  all_df[&quot;NeighborhoodBin&quot;] = df[&quot;Neighborhood&quot;].map(neighborhood_map)
</code></pre>
<p>:::</p>
<p>::: {.output .stream .stdout}<br>    (1456, 111)<br>    (1459, 111)<br>:::</p>
<p>::: {.output .stream .stderr}<br>    &#x2F;tmp&#x2F;ipykernel_33&#x2F;881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.<br>    The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.</p>
<pre><code>For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:427: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  yearbin_df[&quot;GarageYrBltBin&quot;].fillna(&quot;NoGarage&quot;, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:349: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  onehot_df[column_name].fillna(fill_na, inplace=True)
/tmp/ipykernel_33/881269123.py:427: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method(&#123;col: value&#125;, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  yearbin_df[&quot;GarageYrBltBin&quot;].fillna(&quot;NoGarage&quot;, inplace=True)
</code></pre>
<p>:::</p>
<p>::: {.output .stream .stdout}<br>    Training set size: (1456, 403)<br>    Test set size: (1459, 403)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:03.958556Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:03.957417Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:03.965715Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:03.963454Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:03.958513Z&quot;}” id&#x3D;”mmeESEZhfwLG” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#print(&quot;Training set size:&quot;, train_df_munged.shape)</span></span><br><span class="line"><span class="comment">#print(&quot;Test set size:&quot;, test_df_munged.shape)</span></span><br><span class="line">y_train = label_df[<span class="string">&quot;SalePrice&quot;</span>].values</span><br><span class="line"><span class="comment">#train_df_munged.values</span></span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:03.967926Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:03.967187Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.77761Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.775762Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:03.967886Z&quot;}” id&#x3D;”BjCKp9fafwLH” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> ElasticNet, Lasso,  BayesianRidge, LassoLarsIC ,Ridge</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor,  GradientBoostingRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.kernel_ridge <span class="keyword">import</span> KernelRidge</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> make_pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> RobustScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> BaseEstimator, TransformerMixin, RegressorMixin, clone</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold, cross_val_score, train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.780251Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.779099Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.791672Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.788982Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.780214Z&quot;}” id&#x3D;”Va-etw0VfwLI” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Validation function</span></span><br><span class="line">n_folds = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rmsle_cv</span>(<span class="params">model</span>):</span><br><span class="line">    kf = KFold(n_folds, shuffle=<span class="literal">True</span>, random_state=<span class="number">42</span>).get_n_splits(train_df_munged.values)</span><br><span class="line">    rmse= np.sqrt(-cross_val_score(model, train_df_munged.values, y_train, scoring=<span class="string">&quot;neg_mean_squared_error&quot;</span>, cv = kf))</span><br><span class="line">    <span class="keyword">return</span>(rmse)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.794497Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.79319Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.806983Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.805987Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.794415Z&quot;}” id&#x3D;”x_8hoje2fwLI” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lasso = make_pipeline(RobustScaler(), Lasso(alpha =<span class="number">0.0005</span>, random_state=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.809135Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.808479Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.818118Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.817121Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.809103Z&quot;}” id&#x3D;”2L1a4ippfwLJ” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ridge = make_pipeline(RobustScaler(), Ridge(alpha =<span class="number">0.0005</span>, random_state=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.820344Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.819781Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.830105Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.8289Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.820304Z&quot;}” id&#x3D;”XGzf23TBfwLJ” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENet = make_pipeline(RobustScaler(), ElasticNet(alpha=<span class="number">0.0005</span>, l1_ratio=<span class="number">.9</span>, random_state=<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.83199Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.831482Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.843273Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.842117Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.831962Z&quot;}” id&#x3D;”OZBdOhfDfwLK” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KRR = KernelRidge(alpha=<span class="number">0.6</span>, kernel=<span class="string">&#x27;polynomial&#x27;</span>, degree=<span class="number">2</span>, coef0=<span class="number">2.5</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.845539Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.844853Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.854888Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.853864Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.845496Z&quot;}” id&#x3D;”q_ScIdqDfwLK” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GBoost = GradientBoostingRegressor(n_estimators=<span class="number">3000</span>, learning_rate=<span class="number">0.05</span>,</span><br><span class="line">                                   max_depth=<span class="number">4</span>, max_features=<span class="string">&#x27;sqrt&#x27;</span>,</span><br><span class="line">                                   min_samples_leaf=<span class="number">15</span>, min_samples_split=<span class="number">10</span>,</span><br><span class="line">                                   loss=<span class="string">&#x27;huber&#x27;</span>, random_state =<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.861761Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.861293Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.868986Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.867345Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.861721Z&quot;}” id&#x3D;”KpqRxjQEfwLL” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">model_xgb = xgb.XGBRegressor(colsample_bytree=<span class="number">0.4603</span>, gamma=<span class="number">0.0468</span>,</span><br><span class="line">                             learning_rate=<span class="number">0.05</span>, max_depth=<span class="number">3</span>,</span><br><span class="line">                             min_child_weight=<span class="number">1.7817</span>, n_estimators=<span class="number">2200</span>,</span><br><span class="line">                             reg_alpha=<span class="number">0.4640</span>, reg_lambda=<span class="number">0.8571</span>,</span><br><span class="line">                             subsample=<span class="number">0.5213</span>, silent=<span class="number">1</span>,</span><br><span class="line">                             random_state =<span class="number">7</span>, nthread = -<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.871112Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.870666Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:05.881636Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:05.880542Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.871069Z&quot;}” id&#x3D;”-3KR5KzSfwLM” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">model_lgb = lgb.LGBMRegressor(objective=<span class="string">&#x27;regression&#x27;</span>,num_leaves=<span class="number">5</span>,</span><br><span class="line">                              learning_rate=<span class="number">0.05</span>, n_estimators=<span class="number">720</span>,</span><br><span class="line">                              max_bin = <span class="number">55</span>, bagging_fraction = <span class="number">0.8</span>,</span><br><span class="line">                              bagging_freq = <span class="number">5</span>, feature_fraction = <span class="number">0.2319</span>,</span><br><span class="line">                              feature_fraction_seed=<span class="number">9</span>, bagging_seed=<span class="number">9</span>,</span><br><span class="line">                              min_data_in_leaf =<span class="number">6</span>, min_sum_hessian_in_leaf = <span class="number">11</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:05.884208Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:05.882972Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:07.9701Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:07.96887Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:05.884163Z&quot;}” id&#x3D;”iAI7lYFifwLM” outputId&#x3D;”f1f75c21-63e5-4dd2-80d9-b9c241a46aa4” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(lasso)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nLasso score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}</p>
<pre><code>Lasso score: 0.1101 (0.0056)
</code></pre>
<p>:::</p>
<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.227e-02, tolerance: 1.858e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:07.974389Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:07.972508Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:09.135348Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:09.134225Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:07.974319Z&quot;}” id&#x3D;”zPHMd3DZfwLN” outputId&#x3D;”a3b82ff1-8a8d-4fb2-d2a8-e6715914ce35” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(ridge)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nRidge score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}</p>
<pre><code>Ridge score: 0.1744 (0.0794)
</code></pre>
<p>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:09.138691Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:09.137228Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:11.363691Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:11.360553Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:09.138644Z&quot;}” id&#x3D;”wsvP7RWsfwLN” outputId&#x3D;”b0a922bb-af38-4343-c707-9a3e91c7bdb1” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(ENet)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ElasticNet score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.060e-02, tolerance: 1.846e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>    ElasticNet score: 0.1101 (0.0057)<br>:::</p>
<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.445e-02, tolerance: 1.858e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:11.365631Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:11.365181Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:27:12.414974Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:27:12.413787Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:11.365591Z&quot;}” id&#x3D;”99Tsb2d8fwLO” outputId&#x3D;”3e96e669-7363-4dcf-95e8-a149d6b510de” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(KRR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Kernel Ridge score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    Kernel Ridge score: 0.1100 (0.0053)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:27:12.421762Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:27:12.421004Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:28:25.294602Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:28:25.293457Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:27:12.421714Z&quot;}” id&#x3D;”vBlHLFJ9fwLP” outputId&#x3D;”a42a2feb-782b-4480-f79e-4efd68b0085e” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(GBoost)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Gradient Boosting score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    Gradient Boosting score: 0.1146 (0.0070)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:28:25.296955Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:28:25.296236Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:28:41.35319Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:28:41.35197Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:28:25.296917Z&quot;}” id&#x3D;”xh-l-Xi1fwLP” outputId&#x3D;”f450bc3d-94ca-4b63-9719-21243a8695a3” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(model_xgb)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Xgboost score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;xgboost&#x2F;core.py:160: UserWarning: [12:28:25] WARNING: &#x2F;workspace&#x2F;src&#x2F;learner.cc:742:<br>    Parameters: { “silent” } are not used.</p>
<pre><code>  warnings.warn(smsg, UserWarning)
/opt/conda/lib/python3.10/site-packages/xgboost/core.py:160: UserWarning: [12:28:28] WARNING: /workspace/src/learner.cc:742: 
Parameters: &#123; &quot;silent&quot; &#125; are not used.

  warnings.warn(smsg, UserWarning)
/opt/conda/lib/python3.10/site-packages/xgboost/core.py:160: UserWarning: [12:28:31] WARNING: /workspace/src/learner.cc:742: 
Parameters: &#123; &quot;silent&quot; &#125; are not used.

  warnings.warn(smsg, UserWarning)
/opt/conda/lib/python3.10/site-packages/xgboost/core.py:160: UserWarning: [12:28:34] WARNING: /workspace/src/learner.cc:742: 
Parameters: &#123; &quot;silent&quot; &#125; are not used.

  warnings.warn(smsg, UserWarning)
/opt/conda/lib/python3.10/site-packages/xgboost/core.py:160: UserWarning: [12:28:37] WARNING: /workspace/src/learner.cc:742: 
Parameters: &#123; &quot;silent&quot; &#125; are not used.

  warnings.warn(smsg, UserWarning)
</code></pre>
<p>:::</p>
<p>::: {.output .stream .stdout}<br>    Xgboost score: 0.1138 (0.0060)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:28:41.354857Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:28:41.354536Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:28:45.113665Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:28:45.112399Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:28:41.354831Z&quot;}” id&#x3D;”im-DlKOKfwLQ” outputId&#x3D;”11684e54-eff9-4b2e-ba9d-9cbece830143” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = rmsle_cv(model_lgb)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LGBM score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span> .<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.006763 seconds.<br>    You can set <code>force_row_wise=true</code> to remove the overhead.<br>    And if memory is not enough, you can set <code>force_col_wise=true</code>.<br>    [LightGBM] [Info] Total Bins 2144<br>    [LightGBM] [Info] Number of data points in the train set: 1164, number of used features: 356<br>    [LightGBM] [Info] Start training from score 12.018757<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.003268 seconds.<br>    You can set <code>force_col_wise=true</code> to remove the overhead.<br>    [LightGBM] [Info] Total Bins 2147<br>    [LightGBM] [Info] Number of data points in the train set: 1165, number of used features: 355<br>    [LightGBM] [Info] Start training from score 12.020733<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.003351 seconds.<br>    You can set <code>force_col_wise=true</code> to remove the overhead.<br>    [LightGBM] [Info] Total Bins 2138<br>    [LightGBM] [Info] Number of data points in the train set: 1165, number of used features: 354<br>    [LightGBM] [Info] Start training from score 12.019384<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.003389 seconds.<br>    You can set <code>force_col_wise=true</code> to remove the overhead.<br>    [LightGBM] [Info] Total Bins 2149<br>    [LightGBM] [Info] Number of data points in the train set: 1165, number of used features: 355<br>    [LightGBM] [Info] Start training from score 12.030370<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.003794 seconds.<br>    You can set <code>force_col_wise=true</code> to remove the overhead.<br>    [LightGBM] [Info] Total Bins 2149<br>    [LightGBM] [Info] Number of data points in the train set: 1165, number of used features: 357<br>    [LightGBM] [Info] Start training from score 12.020469<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    LGBM score: 0.1151 (0.0052)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:28:45.117681Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:28:45.117306Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:28:45.127884Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:28:45.126814Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:28:45.11765Z&quot;}” id&#x3D;”GHsoUYPSfwLQ” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AveragingModels</span>(BaseEstimator, RegressorMixin, TransformerMixin):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, models</span>):</span><br><span class="line">        self.models = models</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we define clones of the original models to fit the data in</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        self.models_ = [clone(x) <span class="keyword">for</span> x <span class="keyword">in</span> self.models]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Train cloned base models</span></span><br><span class="line">        <span class="keyword">for</span> model <span class="keyword">in</span> self.models_:</span><br><span class="line">            model.fit(X, y)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="comment">#Now we do the predictions for cloned models and average them</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        predictions = np.column_stack([</span><br><span class="line">            model.predict(X) <span class="keyword">for</span> model <span class="keyword">in</span> self.models_</span><br><span class="line">        ])</span><br><span class="line">        <span class="keyword">return</span> np.mean(predictions, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:28:45.130016Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:28:45.129608Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:30:02.432155Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:30:02.430776Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:28:45.129981Z&quot;}” id&#x3D;”SZ7sv1CPfwLR” outputId&#x3D;”8405cc9c-eb12-47f8-9f0b-a4e268c246c0” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">averaged_models = AveragingModels(models = (ENet, GBoost, KRR, lasso))</span><br><span class="line"></span><br><span class="line">score = rmsle_cv(averaged_models)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot; Averaged base models score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.060e-02, tolerance: 1.846e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.445e-02, tolerance: 1.858e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>     Averaged base models score: 0.1077 (0.0057)<br>:::</p>
<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.227e-02, tolerance: 1.858e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:30:02.445104Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:30:02.438776Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:31:19.659278Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:31:19.658128Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:30:02.445038Z&quot;}” id&#x3D;”DwY265LgfwLR” outputId&#x3D;”b3206cb6-e8f7-499a-b893-eba9f1797265” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">averaged_models_ridge = AveragingModels(models = (ENet, GBoost, KRR, ridge))</span><br><span class="line"></span><br><span class="line">score = rmsle_cv(averaged_models_ridge)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot; Averaged base models score: &#123;:.4f&#125; (&#123;:.4f&#125;)\n&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.060e-02, tolerance: 1.846e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.445e-02, tolerance: 1.858e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>     Averaged base models score: 0.1155 (0.0115)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:31:19.672642Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:31:19.6674Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:31:19.69314Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:31:19.691889Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:31:19.67258Z&quot;}” id&#x3D;”60LfVZ3TfwLR” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StackingAveragedModels</span>(BaseEstimator, RegressorMixin, TransformerMixin):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, base_models, meta_model, n_folds=<span class="number">5</span></span>):</span><br><span class="line">        self.base_models = base_models</span><br><span class="line">        self.meta_model = meta_model</span><br><span class="line">        self.n_folds = n_folds</span><br><span class="line"></span><br><span class="line">    <span class="comment"># We again fit the data on clones of the original models</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        self.base_models_ = [<span class="built_in">list</span>() <span class="keyword">for</span> x <span class="keyword">in</span> self.base_models]</span><br><span class="line">        self.meta_model_ = clone(self.meta_model)</span><br><span class="line">        kfold = KFold(n_splits=self.n_folds, shuffle=<span class="literal">True</span>, random_state=<span class="number">156</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Train cloned base models then create out-of-fold predictions</span></span><br><span class="line">        <span class="comment"># that are needed to train the cloned meta-model</span></span><br><span class="line">        out_of_fold_predictions = np.zeros((X.shape[<span class="number">0</span>], <span class="built_in">len</span>(self.base_models)))</span><br><span class="line">        <span class="keyword">for</span> i, model <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.base_models):</span><br><span class="line">            <span class="keyword">for</span> train_index, holdout_index <span class="keyword">in</span> kfold.split(X, y):</span><br><span class="line">                instance = clone(model)</span><br><span class="line">                self.base_models_[i].append(instance)</span><br><span class="line">                instance.fit(X[train_index], y[train_index])</span><br><span class="line">                y_pred = instance.predict(X[holdout_index])</span><br><span class="line">                out_of_fold_predictions[holdout_index, i] = y_pred</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Now train the cloned  meta-model using the out-of-fold predictions as new feature</span></span><br><span class="line">        self.meta_model_.fit(out_of_fold_predictions, y)</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="comment">#Do the predictions of all base models on the test data and use the averaged predictions as</span></span><br><span class="line">    <span class="comment">#meta-features for the final prediction which is done by the meta-model</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        meta_features = np.column_stack([</span><br><span class="line">            np.column_stack([model.predict(X) <span class="keyword">for</span> model <span class="keyword">in</span> base_models]).mean(axis=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> base_models <span class="keyword">in</span> self.base_models_ ])</span><br><span class="line">        <span class="keyword">return</span> self.meta_model_.predict(meta_features)</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:31:19.707458Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:31:19.70174Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:37:09.448828Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:37:09.443006Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:31:19.707392Z&quot;}” id&#x3D;”mjvkoLj0fwLS” outputId&#x3D;”c2b90408-8f1a-4ab2-8cc0-9d0172a478b5” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">stacked_averaged_models = StackingAveragedModels(base_models = (ENet, GBoost, KRR),</span><br><span class="line">                                                 meta_model = lasso)</span><br><span class="line"></span><br><span class="line">score = rmsle_cv(stacked_averaged_models)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Stacking Averaged models score: &#123;:.4f&#125; (&#123;:.4f&#125;)&quot;</span>.<span class="built_in">format</span>(score.mean(), score.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.668e-01, tolerance: 1.479e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 6.314e-02, tolerance: 1.509e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.162e-02, tolerance: 1.465e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 5.781e-02, tolerance: 1.479e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.428e-02, tolerance: 1.413e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 4.646e-02, tolerance: 1.407e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.186e-02, tolerance: 1.429e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.101e-01, tolerance: 1.406e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 5.936e-02, tolerance: 1.420e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>    Stacking Averaged models score: 0.1079 (0.0054)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:37:09.451482Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:37:09.450801Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:43:00.14791Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:43:00.146601Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:37:09.451439Z&quot;}” id&#x3D;”vLUZNZkofwLS” outputId&#x3D;”eb26739f-ef4a-4ae0-c87e-509f808a66f2” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">stacked_averaged_models_ridge = StackingAveragedModels(base_models = (ENet, GBoost, KRR),</span><br><span class="line">                                                 meta_model = ridge)</span><br><span class="line"></span><br><span class="line">score_ridge = rmsle_cv(stacked_averaged_models_ridge)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Stacking Averaged models score: &#123;:.4f&#125; (&#123;:.4f&#125;)&quot;</span>.<span class="built_in">format</span>(score_ridge.mean(), score_ridge.std()))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.668e-01, tolerance: 1.479e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 6.314e-02, tolerance: 1.509e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.162e-02, tolerance: 1.465e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 5.781e-02, tolerance: 1.479e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.428e-02, tolerance: 1.413e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 4.646e-02, tolerance: 1.407e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.186e-02, tolerance: 1.429e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.101e-01, tolerance: 1.406e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 5.936e-02, tolerance: 1.420e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>    Stacking Averaged models score: 0.1079 (0.0054)<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:43:00.150499Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:43:00.149743Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:43:00.158235Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:43:00.156783Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:43:00.150456Z&quot;}” id&#x3D;”KLRxUjTRfwLT” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rmsle</span>(<span class="params">y, y_pred</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sqrt(mean_squared_error(y, y_pred))</span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:43:00.160501Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:43:00.15976Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:44:20.246999Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:44:20.245824Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:43:00.160464Z&quot;}” id&#x3D;”dA1qTLolfwLT” outputId&#x3D;”9332a1c8-b283-4968-af94-9e72c90f2adb” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stacked_averaged_models.fit(train_df_munged.values, y_train)</span><br><span class="line">stacked_train_pred = stacked_averaged_models.predict(train_df_munged.values)</span><br><span class="line">stacked_pred = np.expm1(stacked_averaged_models.predict(test_df_munged.values))</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train, stacked_train_pred))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.192e-01, tolerance: 1.774e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>    0.07384935969780994<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:44:20.249125Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:44:20.248419Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:39.525401Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:39.524008Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:44:20.249087Z&quot;}” id&#x3D;”HmjyZ4kmfwLU” outputId&#x3D;”088cfe95-96b3-4617-b74c-74f3518aad80” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stacked_averaged_models_ridge.fit(train_df_munged.values, y_train)</span><br><span class="line">stacked_train_pred_ridge = stacked_averaged_models_ridge.predict(train_df_munged.values)</span><br><span class="line">stacked_pred_ridge = np.expm1(stacked_averaged_models_ridge.predict(test_df_munged.values))</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train, stacked_train_pred_ridge))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;sklearn&#x2F;linear_model&#x2F;_coordinate_descent.py:631: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 1.192e-01, tolerance: 1.774e-02<br>      model &#x3D; cd_fast.enet_coordinate_descent(<br>:::</p>
<p>::: {.output .stream .stdout}<br>    0.07386785761731066<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:39.527657Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:39.526919Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:48.765306Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:48.763709Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:39.527614Z&quot;}” id&#x3D;”09J8Nk2MfwLU” outputId&#x3D;”d53c4d18-4419-43ac-d131-df6b23c6ece1” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model_xgb.fit(train_df_munged, y_train)</span><br><span class="line">xgb_train_pred = model_xgb.predict(train_df_munged)</span><br><span class="line">xgb_pred = np.expm1(model_xgb.predict(test_df_munged))</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train, xgb_train_pred))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stderr}<br>    &#x2F;opt&#x2F;conda&#x2F;lib&#x2F;python3.10&#x2F;site-packages&#x2F;xgboost&#x2F;core.py:160: UserWarning: [12:45:39] WARNING: &#x2F;workspace&#x2F;src&#x2F;learner.cc:742:<br>    Parameters: { “silent” } are not used.</p>
<pre><code>  warnings.warn(smsg, UserWarning)
</code></pre>
<p>:::</p>
<p>::: {.output .stream .stdout}<br>    0.08404240349359858<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:48.767364Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:48.766892Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.613838Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.612723Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:48.76732Z&quot;}” id&#x3D;”rb3lrNAHfwLU” outputId&#x3D;”6216ef2c-bc2d-4c41-982c-3fdc6afa6d84” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model_lgb.fit(train_df_munged, y_train)</span><br><span class="line">lgb_train_pred = model_lgb.predict(train_df_munged)</span><br><span class="line">lgb_pred = np.expm1(model_lgb.predict(test_df_munged.values))</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train, lgb_train_pred))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] Found whitespace in feature_names, replace with underlines<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.003907 seconds.<br>    You can set <code>force_col_wise=true</code> to remove the overhead.<br>    [LightGBM] [Info] Total Bins 2182<br>    [LightGBM] [Info] Number of data points in the train set: 1456, number of used features: 362<br>    [LightGBM] [Info] Start training from score 12.021943<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    [LightGBM] [Warning] min_sum_hessian_in_leaf is set&#x3D;11, min_child_weight&#x3D;0.001 will be ignored. Current value: min_sum_hessian_in_leaf&#x3D;11<br>    [LightGBM] [Warning] min_data_in_leaf is set&#x3D;6, min_child_samples&#x3D;20 will be ignored. Current value: min_data_in_leaf&#x3D;6<br>    [LightGBM] [Warning] feature_fraction is set&#x3D;0.2319, colsample_bytree&#x3D;1.0 will be ignored. Current value: feature_fraction&#x3D;0.2319<br>    [LightGBM] [Warning] bagging_fraction is set&#x3D;0.8, subsample&#x3D;1.0 will be ignored. Current value: bagging_fraction&#x3D;0.8<br>    [LightGBM] [Warning] bagging_freq is set&#x3D;5, subsample_freq&#x3D;0 will be ignored. Current value: bagging_freq&#x3D;5<br>    0.06926259332568477<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:49.615998Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:49.615135Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.623962Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.622488Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:49.615963Z&quot;}” id&#x3D;”q6_P35_VfwLV” outputId&#x3D;”5a4e4bd7-3803-4a5f-f477-24d148d8cc34” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;RMSE on the entire Train data when averaging&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;RMSLE score on train data:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train,stacked_train_pred*<span class="number">0.7</span> +</span><br><span class="line">               xgb_train_pred*<span class="number">0.15</span> + lgb_train_pred*<span class="number">0.15</span>))  <span class="comment">#0.75 0.125 0.125</span></span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    RMSLE score on train data:<br>    0.07282898327817613<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:49.626073Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:49.625748Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.642151Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.640789Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:49.626047Z&quot;}” id&#x3D;”UWSjaVTAfwLV” outputId&#x3D;”acf64dee-88a8-44a4-986c-5f49f20a344d” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;RMSE on the entire Train data when averaging&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;RMSLE_ridge score on train data:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(rmsle(y_train,stacked_train_pred_ridge*<span class="number">0.7</span> +</span><br><span class="line">               xgb_train_pred*<span class="number">0.15</span> + lgb_train_pred*<span class="number">0.15</span>))</span><br></pre></td></tr></table></figure>

<p>::: {.output .stream .stdout}<br>    RMSLE_ridge score on train data:<br>    0.0728370672457598<br>:::<br>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:49.643749Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:49.64336Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.658804Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.657761Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:49.64371Z&quot;}” id&#x3D;”dFqq7RSjfwLV” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ensemble = stacked_pred*<span class="number">0.85</span> + xgb_pred*<span class="number">0.075</span> + lgb_pred*<span class="number">0.075</span></span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:49.660046Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:49.659681Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.672446Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.671251Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:49.66001Z&quot;}” id&#x3D;”W6d6ac_FfwLW” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ensemble_ridge = stacked_pred_ridge*<span class="number">0.75</span> + xgb_pred*<span class="number">0.125</span> + lgb_pred*<span class="number">0.125</span></span><br></pre></td></tr></table></figure>
<p>:::</p>
<p>::: {.cell .code execution&#x3D;”{&quot;iopub.execute_input&quot;:&quot;2024-04-29T12:45:49.674064Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-04-29T12:45:49.67372Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-04-29T12:45:49.694069Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-04-29T12:45:49.693146Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-04-29T12:45:49.674036Z&quot;}” id&#x3D;”1fsXzwEufwLl” trusted&#x3D;”true”}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sub = pd.DataFrame()</span><br><span class="line">test_ID = test_df[<span class="string">&#x27;Id&#x27;</span>]</span><br><span class="line">sub[<span class="string">&#x27;Id&#x27;</span>] = test_ID</span><br><span class="line">sub[<span class="string">&#x27;SalePrice&#x27;</span>] = ensemble_ridge</span><br><span class="line">sub.to_csv(<span class="string">&#x27;submission.csv&#x27;</span>,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>:::</p>
</div><div class="article-licensing box"><div class="licensing-title"><p><a href="http://example.com/2024/04/30/vertopal.com_[to_be_finished]_House_Price/">http://example.com/2024/04/30/vertopal.com_[to_be_finished]_House_Price/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Jiahe (Paddy) ZHAO</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2024-04-30</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-04-30</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/11/21/oneFunnyDay/"><span class="level-item">oneFunnyDay</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://assets-global.website-files.com/653dcbdd718cbd5c51c4dbed/653f5e8549a0fbf7dc295818_IMG_20190205_193746-p-500.jpg" alt="Jiahe(Paddy) ZHAO"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jiahe(Paddy) ZHAO</p><p class="is-size-6 is-block">Paddy&#039;s Log BooK</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hebei, CHINA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">4</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/PaddyZz" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/PaddyZz"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Happy/"><span class="tag">Happy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/One-Plesant-Day/"><span class="tag">One Plesant Day</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sad/"><span class="tag">sad</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tired/"><span class="tag">tired</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-30T11:45:26.574Z">2024-04-30</time></p><p class="title"><a href="/2024/04/30/vertopal.com_%5Bto_be_finished%5D_House_Price/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-21T11:05:54.000Z">2023-11-21</time></p><p class="title"><a href="/2023/11/21/oneFunnyDay/">oneFunnyDay</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-28T06:23:44.000Z">2023-10-28</time></p><p class="title"><a href="/2023/10/28/todaySoTired/">todaySoTired</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-28T06:23:44.000Z">2023-10-28</time></p><p class="title"><a href="/2023/10/28/todayIsSoTired/">todayIsSoTired</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-24T04:14:17.244Z">2023-10-24</time></p><p class="title"><a href="/2023/10/24/hello-world/">Hello World</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Jiahe (Paddy) ZHAO&#039;s log book" height="28"></a><p class="is-size-7"><span>&copy; 2024 Jiahe (Paddy) ZHAO</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>